"""
config.py

이 파일은 프로젝트 전반에서 사용되는 설정값들을 모아놓은 파일입니다.
설정을 한 곳에 모아두면 나중에 값을 바꾸기 쉽습니다.
"""

from dataclasses import dataclass

# @dataclass 데코레이터: 클래스를 데이터 저장용 클래스로 만듭니다
# frozen=True: 클래스 생성 후 값을 변경할 수 없게 만듭니다 (불변 객체)
@dataclass(frozen=True)
class Settings:
    """
    프로젝트 전체 설정을 저장하는 클래스
    
    이 클래스는 프로젝트에서 사용하는 모든 설정값을 한 곳에 모아둡니다.
    예: 어떤 AI 모델을 사용할지, 검색할 때 몇 개를 가져올지 등
    """
    
    # ========================================
    # 임베딩 모델 설정
    # ========================================
    # 임베딩 모델: 텍스트를 숫자(벡터)로 변환하는 데 사용하는 AI 모델
    # "intfloat/multilingual-e5-base"는 다국어(한국어 포함)를 잘 처리하는 오픈소스 모델입니다
    # 이 모델은 Hugging Face에서 제공하며, 처음 실행 시 자동으로 다운로드됩니다 (약 420MB)
    embedding_model_name: str = "intfloat/multilingual-e5-base"

    # ========================================
    # Ollama 설정
    # ========================================
    # Ollama 로컬 서버 주소
    # Ollama는 기본적으로 컴퓨터의 11434번 포트에서 실행됩니다
    # Ollama를 다른 포트에서 실행한다면 여기를 변경하세요
    ollama_base_url: str = "http://localhost:11434"

    # 사용할 LLM (Large Language Model, 대규모 언어 모델) 이름
    # 이 이름은 Ollama에서 다운로드한 모델 이름과 정확히 일치해야 합니다
    # 예: "ollama pull llama3.1:8b" 명령어로 다운로드한 경우, 여기에 "llama3.1:8b"를 적어야 함
    # "8b"는 모델 크기(80억 파라미터)를 의미하며, 더 작은 모델(예: 7b)을 사용하면 속도는 빠르지만 정확도가 떨어질 수 있습니다
    ollama_model: str = "llama3.1:8b"

    # ========================================
    # 검색 설정
    # ========================================
    # 검색 시 가져올 문서 조각(청크)의 개수
    # 예: top_k=3 이면 질문과 가장 유사한 3개의 문서 조각을 가져옵니다
    # 값을 늘리면 더 많은 정보를 참고하지만, 프롬프트가 길어져 생성 시간이 늘어납니다
    # 값을 줄이면 관련성이 높은 정보만 참고하고, 생성 시간이 단축됩니다
    # 속도 최적화를 위해 기본값을 3으로 설정 (정확도와 속도의 균형)
    top_k: int = 3

    # 코사인 유사도 임계값 (0.0 ~ 1.0 사이의 값)
    # 검색한 문서 조각과 질문의 유사도가 이 값보다 낮으면 "관련 정보를 찾기 어렵습니다"라고 응답합니다
    # 이렇게 하는 이유: 관련성이 낮은 정보로 답변하면 오해를 줄 수 있기 때문입니다
    # 
    # 값이 너무 낮으면 (예: 0.10): 관련 없는 정보도 답변에 포함될 위험이 있습니다
    # 값이 너무 높으면 (예: 0.60): 정확한 답변이 있어도 "찾기 어렵습니다"라고 응답할 수 있습니다
    # 
    # 기술적 설명: 임베딩이 정규화(normalize)되어 있기 때문에,
    # inner product(내적) 연산 결과가 코사인 유사도와 동일한 의미를 가집니다
    min_similarity: float = 0.30

# Settings 클래스의 인스턴스를 생성합니다
# 다른 파일에서는 "from config import SETTINGS"로 이 객체를 가져와서 사용합니다
SETTINGS = Settings()
